Kontext: MVP Requirements DocumentVersion: 1.3Date: August 21, 2025Project Goal: To create a Minimum Viable Product (MVP) of a CLI tool named "Kontext" that allows developers to define and switch between distinct development profiles, automating the management of their shell environment and Git configurations.## 1. Core PhilosophyThe tool must be fast, unobtrusive, and simple to configure. The primary goal is to eliminate the manual, error-prone process of juggling configurations between different projects (e.g., work vs. personal). The core user experience will revolve around a command-line interface (CLI) and automatic, directory-based context switching.## 2. Core Features (MVP Scope)2.1. Profile ManagementProfile Definition: Users must be able to define profiles in a human-readable format. Each profile will be a separate YAML file (e.g., work.yml, personal.yml) located in a central directory (~/.config/kontext/profiles/). This file is the single source of truth for a profile's configuration.Profile Creation: The CLI must include an interactive command (kontext new) to guide the user through creating a new profile file.Profile Listing: The CLI must have a command (kontext list) to display all available profiles.2.2. Manual Profile SwitchingThe CLI must provide a command (kontext switch <profile-name>) to manually activate a specific profile in the current shell session.The CLI must provide a command (kontext current) to show the name of the currently active profile.2.3. Shell Environment ConfigurationEnvironment Variables: A profile must be able to define a set of environment variables to export upon activation.Aliases & Functions: A profile must be able to source a shell script (.sh) file to define custom aliases and functions specific to that context.2.4. Git Identity ManagementEach profile must be able to specify a user.name and user.email.Upon activation, the tool will dynamically update the user's Git configuration to use the profile's identity. This will be implemented using Git's includeIf directive for robustness.## 3. Key Feature: Directory-Based ActivationThis is the central feature for a seamless user experience.Activation Trigger: The tool will automatically switch to a profile when the user navigates into a directory (or any of its subdirectories) containing a .kontext-profile file.Configuration File: The .kontext-profile file will contain the name of the profile to be activated (e.g., the word work).Clarification on Roles: The profile's detailed configuration is defined only once in its YAML file (e.g., work.yml). The .kontext-profile file acts only as a simple trigger or pointer, telling Kontext which YAML definition to load for that directory.Shell Integration: This will be achieved by providing a one-time setup command (kontext init) that the user adds to their .bashrc or .zshrc. This command will inject the necessary shell logic to hook into the cd command and the prompt display.## 4. Technical SpecificationsLanguage: TypeScriptRuntime: Node.js (LTS version recommended)Distribution: The final product will be packaged into a single executable using a tool like pkg or nexe to ensure easy, dependency-free installation for users.CLI Framework: Commander.js will be used to build the command structure, handle arguments, and generate help menus.Configuration Parsing: js-yaml will be used to parse the YAML profile files.Shell Interaction: The tool will generate shell scripts (bash/zsh) on the fly for the kontext init and kontext switch commands to manipulate the user's live shell environment.## 5. Ideal User WorkflowThis section describes the intended user experience from initial setup to daily use, focusing on a clear and helpful onboarding process.5.1. One-Time Setup: Shell IntegrationInstallation: The user downloads the single kontext executable and places it in their PATH.Initialization: The user runs kontext init. The tool provides a friendly, guided experience:It detects the user's shell (e.g., zsh).It prints clear instructions and a safe, copy-pasteable command to modify their shell configuration.Example Output:# Welcome to Kontext! To finish installation, add the hook to your shell.

# We've detected you are using zsh.

# Run the following command to add the hook to your ~/.zshrc file:

echo 'eval "$(kontext hook init)"' >> ~/.zshrc

# Restart your shell for the changes to take effect.

Confirmation and Next Steps: After the user runs the command and restarts their shell, the tool is fully integrated. The init command will now suggest the next logical step:âœ… Success! Kontext is now integrated with your shell.

Next, create your first profile by running:
kontext new
5.2. Profile Creation & Directory TaggingDefine Contexts: Following the prompt, the user runs kontext new. They are guided through an interactive wizard to create their first profile (e.g., work), defining its Git identity and environment variables. They repeat this for any other profiles (e.g., personal).Designate Directories: The user navigates to a root directory for a context (e.g., cd ~/company/) and creates a trigger file by running echo "work" > .kontext-profile.5.3. Daily Use: The Automatic WorkflowNavigate: The user cd's into any project directory (e.g., cd ~/company/project-alpha).Automatic Switch: Kontext detects the .kontext-profile file in a parent directory and instantly activates the work profile, updating the shell environment and Git config.Visual Feedback: The user's shell prompt changes to reflect the active context (e.g., (work) $), confirming the switch. The developer can now work with the correct tools and identity without any manual commands.## 6. Out of Scope for MVPTo ensure a focused and achievable initial release, the following features will not be included in the MVP:Graphical User Interface (GUI): The tool will be CLI-only.Advanced Git Management: SSH/GPG key switching will be deferred.Application Dotfile Symlinking: Managing configs for VS Code, npm, etc., is a post-MVP feature.Cross-Shell Support: Initial support will be focused on Bash and Zsh. Support for Fish, PowerShell, etc., will be considered later.Hooks (on_activate/on_deactivate): Custom script execution on profile switching is a post-MVP feature.
